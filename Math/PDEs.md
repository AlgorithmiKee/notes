---
title: "PDEs"
date: "2024"
author: "Ke Zhang"
---

# Partial Differential Equations

[toc]

$$
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
$$

## Continuity Equation

The continuity equation is a first-order partial differential equation expressing local mass conservation in  fluid mechanics. It can be understood from two perspectives:

* Eulerian perspective: Intutively, we observe the fluid at a fixed location and at a fixed time. We describe the local change.
* Lagrange perspective: Trace a single particle along the flow.

### Eulerian Perspective

In Eulerian perspective, a fluid is described by its density and velocity:

* $\rho(\mathbf{x}, t)$: density at location $\mathbf{x} \in\mathbb R^n$ and time $t$. Time-dependent scalar field.
* $\mathbf{u}(\mathbf{x}, t)$: velocity at location $\mathbf{x} \in\mathbb R^n$ and time $t$. Time-dependent vector field.

W.l.o.g., we assume the time $t \in [0,1]$.

Let $\Omega \subseteq \mathbb{R}^n$ be a fixed **control volume** with boundary $\partial \Omega$. By conservation of mass, we have for any $t$:

$$
\begin{align}
\frac{\mathrm d}{\mathrm dt} \int_{\Omega} \rho \:\mathrm{d} V
&= - \oint_{\partial\Omega} \rho \mathbf{u} \:\mathrm d \mathbf{A}
\end{align}
$$

Remarks:

* The LHS describes the rate of change of the mass inside the volume $\Omega$.
* The integral on RHS describes the net outflow out of the surface $\partial\Omega$. Positive net outflow reduces the mass inside $\Omega$, hence we need the minus sign.
* The conservation of mass holds at any location $\mathbf{x}$ and at any time $t$.

On the LHS, we can exchanging the order of integral and time derivative.

$$
\frac{\mathrm d}{\mathrm dt} \int_{\Omega} \rho \:\mathrm{d} V
= \int_{\Omega} \frac{\partial}{\partial t}  \rho \:\mathrm{d} V
$$

On the RHS, we apply the Gaussian integral law.

$$
\oint_{\partial\Omega} \rho \mathbf{u} \:\mathrm d \mathbf{A}
= \int_{\Omega}  \operatorname{div} (\rho \mathbf{u}) \:\mathrm d V
$$

Together,

$$
\begin{align*}
\int_{\Omega} \frac{\partial}{\partial t}  \rho \:\mathrm{d} V
&= - \int_{\Omega}  \operatorname{div} (\rho \mathbf{u}) \:\mathrm d V
\end{align*}
$$

Rearranging the term yields

$$
\begin{align*}
\int_{\Omega} \left[
    \frac{\partial}{\partial t}  \rho + \operatorname{div} (\rho \mathbf{u})
\right]\:\mathrm dV = 0
\end{align*}
$$

Recall this equality must hold everywhere at any time. Hence, the integrand must be zero function. Therefore, we conclude the ***continuity equation*** in fluid mechanics.

$$
\begin{align}
\frac{\partial}{\partial t}  \rho + \operatorname{div} (\rho \mathbf{u}) = 0
\end{align}
$$

Remarks:

* Again, the contiuity equation holds everywhere at any time.
* For incompressible flow ($\rho = \text{const}$), the contiuity equation simplies to
  $$
  \operatorname{div} (\rho \mathbf{u}) = 0
  $$

Using the product rule in multivariate calculus

$$
\operatorname{div} (\rho \mathbf{u}) = \mathbf{u} \cdot \nabla \rho + \rho \operatorname{div} \mathbf{u}
$$

The contiuity equation can be reformulated as

$$
\begin{align}
\frac{\partial \rho}{\partial t} + \mathbf{u} \cdot \nabla \rho + \rho (\operatorname{div} \mathbf{u}) = 0
\end{align}
$$

### Lagrange Perspective

The Lagrange perspective focus on describing the movement of each individual fluid particles. Let $\mathbf{x}(t)$ be the positional vector of a particular (weightless) particle at time $t$. This particle traces a trajectory generated by the ODE

$$
\begin{align}
\dot{\mathbf{x}}(t) = \mathbf{u}(\mathbf{x}(t), t), \quad
\mathbf{x}(0) = \mathbf{x}_0
\end{align}
$$

where

* $\mathbf{u}: \mathbb R^n \times [0,1] \to \mathbb R^n$ is same the time-dependent vector field used in Eulerian perspective.
* $\mathbf{x}_0 \in \mathbb R^n$ is the initial position of the particle at $t=0$.

To describe the movement of all fluid particles, we use the same ODE above but vary $\mathbf{x}_0$. Each distinct initial position yields another trajectory. To encode the trajectories of all particles, we define the ***flow map***:

$$
\begin{align}
\boldsymbol{\phi}: [0,1] \times \mathbb R^n \to \mathbb R^n
\end{align}
$$

s.t.

$$
\begin{align}
\dot{\boldsymbol{\phi}}(t, \mathbf{x}_0) = \mathbf{u}(\boldsymbol{\phi}(t, \mathbf{x}_0), t)
\end{align}
$$

Remarks:

* The trajectory $\mathbf{x}(\cdot)$ is the solution to the ODE subject to a specific initial condition. It describes the movement of a single particle.
* The flow map $\boldsymbol{\phi}$ represents the family of solutions to the ODE subject to all possible initial conditions. It describes the movement of all particles.
* $\boldsymbol{\phi}(t, \mathbf{x}_0)$ describes the location of a particle at time $t$ by starting from $\mathbf{x}_0$ and then following the ODE.
* Our intuition so far is built upon the drift of a weightless particle. Later, we will replace this particle with a inifinitely small control volumne drifting along the velocity field.

TODO: bridge the density and ODE